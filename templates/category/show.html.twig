{% extends 'base.html.twig' %}

{% block title %}Hello ShopController!{% endblock %}
{% block page_keywords %}Jeans, Ranked Choice Homepage, Jackets{% endblock %}
{% block page_description %}Main page of RankedChoice shop!{% endblock %}

{% block stylesheets %}
    <style>
        .page-title {
            font-size: 4rem;
            font-weight: 100;
            border-bottom: 4px solid #ff59bd !important;
            #-webkit-clip-path: polygon(5% 0%, 100% 0, 95% 100%, 0% 100%);
            #clip-path: polygon(5% 0%, 100% 0%, 95% 100%, 0% 100%);
        }
        .products-count {
            margin-right: 5rem;
        }
        .products-sort {
            margin-left: 5rem;
            display: flex; text-align: center; justify-content: center; align-items: center;
        }
        .products-sort select {
            margin-bottom: 0 !important;
        }
        .page-header {
            background-color: #DFDBE5;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.1' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='3'/%3E%3Ccircle cx='13' cy='13' r='3'/%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
    {{ encore_entry_link_tags('appMainCategoryShow') }}
{% endblock %}

{% block body %}
    <div id="app"></div>
{% endblock %}

{% block javascripts %}
    <script>
        function addProductToCart(productData)
        {
            let cartJSON = sessionStorage.getItem('cart');
            let cart = cartJSON ? JSON.parse(cartJSON) : [];
            cart = cart.filter(item => {
                return item.id !== productData.id
            })
            cart.push({
                id: productData.id,
                title: productData.title,
                categoryName: productData.category.title,
                price: productData.price,
                image: productData.images.length
                    ? productData.images[0].filenameSmall
                    : null,
                quantity: 1
            })

            sessionStorage.setItem('cart', JSON.stringify(cart));
            window.vueMenuCartInstance.getProductsOfCart()
        }

        console.log(sessionStorage.getItem('cart'))
    </script>
    <script>
        if (typeof window.staticStore === 'undefined') {
            window.staticStore = {}
        }
        window.staticStore.offset = 0
        window.staticStore.limit = 4
        window.staticStore.selectedCategory = JSON.parse('{{ categoryModel|json_encode|raw }}')
        window.staticStore.urlProductShow = "{{ path('product_show_blank') }}"
        window.staticStore.urlAssetImageProducts = "{{ asset('uploads/images/products') }}"
        window.staticStore.urlGetCountOfProductsByCategory = "{{ path('product_get_count_of_products_by_category') }}"
        window.staticStore.urlGetProductsByCategory = "{{ path('product_get_products_by_category') }}"
        window.staticStore.addProductToCart = addProductToCart
    </script>
    {{ encore_entry_script_tags('appMainCategoryShow') }}
{% endblock %}
